<% if (page.comments) {%>
<%
let commentList = injector('comment').rendered();
%>
<% if (commentList.length === 1) { %>
<%- commentList[0].value -%>
<% } else if (commentList.length > 1) { %>
<div class='comment-button-group'>
  <% commentList.forEach(inject_item => { %>
  <a class='btn comment-button <%= inject_item.locals.class %>'><%- inject_item.locals.button -%></a>
  <% }); %>
</div>
<% commentList.forEach(inject_item => { %>
<div class='comment-position <%= inject_item.locals.class %>'>
  <%- inject_item.value -%>
</div>
<% }); %>
<script>
  let commentButton = document.querySelectorAll('.comment-button');
  commentButton.forEach(item => {
    let commentClass = item.classList[2];
    item.addEventListener("click", () => {
      commentButton.forEach(rmActive => rmActive.classList.remove('active'));
      item.classList.add('active');
      document.querySelectorAll('.comment-position').forEach(rmActive => rmActive.classList.remove('active'));
      document.querySelector(`.comment-position.${commentClass}`).classList.add('active');
      localStorage.setItem('comments_active', commentClass);
    })
  })
  let activeClass = localStorage.getItem('comments_active') || CONFIG.comments.activeClass;
  if (activeClass) {
    let activeButton = document.querySelector(`.comment-button.${activeClass}`);
    if (activeButton) {
      activeButton.click();
    }
  }
</script>
<%
  }
}
%>
